<!doctype html>
<html lang="th" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≤‡∏¢‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
      font-family: 'Prompt', sans-serif;
    }
    
    .glow-animation {
      animation: glow 0.5s ease-out;
    }
    
    @keyframes glow {
      0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
      50% { box-shadow: 0 0 20px 10px rgba(34, 197, 94, 0.4); }
      100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
    }
    
    .toast {
      animation: slideIn 0.3s ease-out, fadeOut 0.3s ease-in 2.7s;
    }
    
    @keyframes slideIn {
      from { transform: translateY(100%); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .number-cell {
      transition: all 0.2s ease;
    }
    
    .number-cell:hover {
      transform: scale(1.05);
    }
    
    .board-card {
      transition: all 0.3s ease;
    }
    
    .board-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 24px rgba(0,0,0,0.15);
    }
    
    /* Dark Mode Styles */
    body.dark-mode {
      background: linear-gradient(to bottom right, #111827, #1f2937, #111827);
      color: #f3f4f6;
    }
    
    body.dark-mode .bg-white {
      background-color: #1f2937 !important;
      color: #f3f4f6;
    }
    
    body.dark-mode .text-gray-800 {
      color: #f3f4f6 !important;
    }
    
    body.dark-mode .text-gray-600 {
      color: #9ca3af !important;
    }
    
    body.dark-mode .text-gray-500 {
      color: #6b7280 !important;
    }
    
    body.dark-mode .bg-gray-100 {
      background-color: #374151 !important;
    }
    
    body.dark-mode .bg-gray-200 {
      background-color: #4b5563 !important;
    }
    
    body.dark-mode .border-gray-200 {
      border-color: #374151 !important;
    }
    
    body.dark-mode .border-indigo-200 {
      border-color: #4338ca !important;
    }
    
    body.dark-mode .border-orange-200 {
      border-color: #c2410c !important;
    }
    
    body.dark-mode .hover\:bg-gray-100:hover {
      background-color: #374151 !important;
    }
    
    body.dark-mode .hover\:bg-gray-200:hover {
      background-color: #4b5563 !important;
    }
    
    body.dark-mode input,
    body.dark-mode select,
    body.dark-mode button {
      color: #f3f4f6;
    }
    
    body.dark-mode .from-indigo-50 {
      --tw-gradient-from: rgba(79, 70, 229, 0.2) !important;
    }
    
    body.dark-mode .to-purple-50 {
      --tw-gradient-to: rgba(139, 92, 246, 0.2) !important;
    }
    
    body.dark-mode .from-orange-50 {
      --tw-gradient-from: rgba(249, 115, 22, 0.2) !important;
    }
    
    body.dark-mode .to-pink-50 {
      --tw-gradient-to: rgba(236, 72, 153, 0.2) !important;
    }
    
    .loading-spinner {
      border: 3px solid #f3f4f6;
      border-top: 3px solid #6366f1;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 text-gray-800 overflow-auto">
  <div id="app" class="h-full w-full"><!-- Loading Screen -->
   <div id="loading-screen" class="fixed inset-0 z-50 flex items-center justify-center bg-gradient-to-br from-indigo-500 to-purple-600">
    <div class="text-center">
     <div class="loading-spinner mx-auto mb-4"></div>
     <p class="text-white text-xl font-semibold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
    </div>
   </div><!-- Toast Container -->
   <div id="toast-container" class="fixed bottom-24 left-1/2 transform -translate-x-1/2 z-50 flex flex-col gap-2"></div><!-- Top Bar -->
   <div class="fixed top-0 right-0 z-40 p-4 flex items-center gap-4">
    <div id="clock" class="text-2xl font-bold bg-white/80 backdrop-blur px-4 py-2 rounded-xl shadow-lg border border-white/50">
     00:00:00
    </div><button onclick="toggleDarkMode()" class="p-3 bg-white/80 backdrop-blur rounded-xl shadow-lg border border-white/50 hover:scale-105 transition-transform">
     <svg id="dark-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
     </svg>
     <svg id="light-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
     </svg></button>
   </div><!-- Admin FAB --> <button onclick="showAdminLogin()" class="fixed bottom-6 right-6 z-40 w-14 h-14 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-full shadow-xl flex items-center justify-center hover:scale-110 transition-transform">
    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
    </svg></button> <!-- HOME PAGE -->
   <div id="home-page" class="min-h-full p-6 pt-20">
    <div class="max-w-7xl mx-auto"><!-- Header -->
     <div class="text-center mb-8">
      <h1 id="site-title" class="text-5xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-2">‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≤‡∏¢‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h1>
      <p class="text-gray-500">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏ö‡∏à‡∏ö‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</p>
     </div><!-- ============================================ --> <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≤‡∏¢‡πÄ‡∏ö‡∏≠‡∏£‡πå --> <!-- ============================================ -->
     <div class="bg-gradient-to-br from-indigo-50 to-purple-50 rounded-3xl p-8 mb-8 border-4 border-indigo-200">
      <div class="flex justify-between items-center mb-6">
       <div>
        <h2 class="text-3xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-2">üíé ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≤‡∏¢‡πÄ‡∏ö‡∏≠‡∏£‡πå</h2>
        <p class="text-gray-600">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏á‡πÄ‡∏ö‡∏≠‡∏£‡πå ‡∏à‡∏≠‡∏á‡πÄ‡∏•‡∏Ç ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</p>
       </div>
       <div class="flex gap-3"><button onclick="refreshBoards()" class="group flex items-center gap-3 px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl hover:scale-105 transition-all">
         <svg class="w-6 h-6 group-hover:rotate-180 transition-transform duration-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
         </svg> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä </button> <button onclick="addNewBoard()" class="group flex items-center gap-3 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl hover:scale-105 transition-all">
         <svg class="w-6 h-6 group-hover:rotate-90 transition-transform" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
         </svg> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ú‡∏á‡πÉ‡∏´‡∏°‡πà </button>
       </div>
      </div><!-- ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏ö‡∏≠‡∏£‡πå -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
       <div class="bg-white p-6 rounded-xl shadow-lg text-center">
        <div class="text-4xl font-bold text-indigo-600 mb-1" id="total-boards">
         0
        </div>
        <div class="text-sm text-gray-500">
         ‡πÅ‡∏ú‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        </div>
       </div>
       <div class="bg-white p-6 rounded-xl shadow-lg text-center">
        <div class="text-4xl font-bold text-green-600 mb-1" id="total-sold">
         0
        </div>
        <div class="text-sm text-gray-500">
         ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢
        </div>
       </div>
       <div class="bg-white p-6 rounded-xl shadow-lg text-center">
        <div class="text-4xl font-bold text-blue-600 mb-1" id="total-revenue">
         ‡∏ø0
        </div>
        <div class="text-sm text-gray-500">
         ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢
        </div>
       </div>
       <div class="bg-white p-6 rounded-xl shadow-lg text-center">
        <div class="text-4xl font-bold text-purple-600 mb-1" id="avg-percent">
         0%
        </div>
        <div class="text-sm text-gray-500">
         ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ %
        </div>
       </div>
      </div><!-- Boards Grid -->
      <div id="boards-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><!-- Boards will be rendered here -->
      </div>
      <div id="empty-state" class="text-center py-16">
       <div class="text-8xl mb-4">
        üìã
       </div>
       <h3 class="text-2xl font-semibold text-gray-600 mb-2">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏ú‡∏á</h3>
       <p class="text-gray-500">‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ú‡∏á‡πÉ‡∏´‡∏°‡πà" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</p>
      </div>
     </div><!-- ============================================ --> <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ --> <!-- ============================================ -->
     <div class="bg-gradient-to-br from-orange-50 to-pink-50 rounded-3xl p-8 mb-8 border-4 border-orange-200">
      <div class="flex justify-between items-center mb-6">
       <div>
        <h2 class="text-3xl font-bold bg-gradient-to-r from-orange-600 to-pink-600 bg-clip-text text-transparent mb-2">üì¶ ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
        <p class="text-gray-600">‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤ ‡∏Ç‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πá‡∏≠‡∏Å ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≥‡πÑ‡∏£</p>
       </div>
       <div class="flex gap-3"><button onclick="refreshProducts()" class="group flex items-center gap-3 px-6 py-3 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl hover:scale-105 transition-all">
         <svg class="w-6 h-6 group-hover:rotate-180 transition-transform duration-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
         </svg> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä </button> <button onclick="showAddProductModal()" class="group flex items-center gap-3 px-6 py-3 bg-gradient-to-r from-orange-500 to-pink-600 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl hover:scale-105 transition-all">
         <svg class="w-6 h-6 group-hover:rotate-90 transition-transform" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
         </svg> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ </button>
       </div>
      </div><!-- ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ï‡πá‡∏≠‡∏Å -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
       <div class="bg-white p-6 rounded-xl shadow-lg text-center">
        <div class="text-4xl font-bold text-cyan-600 mb-1" id="total-products">
         0
        </div>
        <div class="text-sm text-gray-500">
         ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        </div>
       </div>
       <div class="bg-white p-6 rounded-xl shadow-lg text-center">
        <div class="text-4xl font-bold text-amber-600 mb-1" id="total-stock">
         0
        </div>
        <div class="text-sm text-gray-500">
         ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠
        </div>
       </div>
       <div class="bg-white p-6 rounded-xl shadow-lg text-center">
        <div class="text-4xl font-bold text-green-600 mb-1" id="total-stock-sold">
         0
        </div>
        <div class="text-sm text-gray-500">
         ‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß
        </div>
       </div>
       <div class="bg-white p-6 rounded-xl shadow-lg text-center">
        <div class="text-4xl font-bold text-emerald-600 mb-1" id="total-stock-profit">
         ‡∏ø0
        </div>
        <div class="text-sm text-gray-500">
         ‡∏Å‡∏≥‡πÑ‡∏£‡∏£‡∏ß‡∏°
        </div>
       </div>
      </div><!-- Products List -->
      <div id="products-list" class="space-y-3"><!-- Products will be rendered here -->
      </div>
      <div id="products-empty" class="text-center py-16">
       <div class="text-8xl mb-4">
        üì¶
       </div>
       <h3 class="text-2xl font-semibold text-gray-600 mb-2">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
       <p class="text-gray-500">‡∏Ñ‡∏•‡∏¥‡∏Å "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</p>
      </div>
     </div>
    </div>
   </div><!-- BOARD PAGE -->
   <div id="board-page" class="hidden min-h-full p-6">
    <div class="max-w-6xl mx-auto">
     <div class="flex justify-between items-center mb-6"><button onclick="goHome()" class="flex items-center gap-2 px-4 py-2 bg-white/80 backdrop-blur rounded-xl shadow-lg border border-white/50 hover:scale-105 transition-transform">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
       </svg> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ Home </button>
      <div class="flex items-center gap-3"><button onclick="refreshBoard()" class="flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-500 to-cyan-600 text-white rounded-xl shadow-lg hover:scale-105 transition-transform font-semibold">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
        </svg> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä </button>
       <div class="flex items-center gap-2 px-4 py-2 bg-white/80 backdrop-blur rounded-xl shadow-lg border border-white/50">
        <svg class="w-5 h-5 text-amber-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg><span id="board-clock" class="font-mono font-semibold">00:00:00</span>
       </div>
      </div>
     </div>
     <div class="bg-white/90 backdrop-blur rounded-2xl shadow-xl border border-white/50 p-6 mb-6">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-center">
       <div class="lg:col-span-1"><label for="board-name-input" class="block text-sm text-gray-500 mb-1">‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ú‡∏á</label> <input type="text" id="board-name-input" class="w-full px-4 py-2 bg-gray-100 rounded-lg border-0 font-semibold text-lg focus:ring-2 focus:ring-indigo-500" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ú‡∏á">
       </div>
       <div><label for="board-date-input" class="block text-sm text-gray-500 mb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏á‡∏ß‡∏î</label> <input type="date" id="board-date-input" class="w-full px-4 py-2 bg-gray-100 rounded-lg border-0 focus:ring-2 focus:ring-indigo-500">
       </div>
       <div><label for="board-price-input" class="block text-sm text-gray-500 mb-1">‡∏£‡∏≤‡∏Ñ‡∏≤/‡πÄ‡∏•‡∏Ç</label> <input type="number" id="board-price-input" class="w-full px-4 py-2 bg-gray-100 rounded-lg border-0 focus:ring-2 focus:ring-indigo-500" placeholder="100" min="0">
       </div>
       <div><label class="block text-sm text-gray-500 mb-1">% ‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß</label>
        <div class="relative">
         <div class="w-full h-10 bg-gray-200 rounded-lg overflow-hidden">
          <div id="board-progress" class="h-full bg-gradient-to-r from-green-400 to-emerald-500 transition-all duration-500" style="width: 0%"></div>
         </div><span id="board-percent" class="absolute inset-0 flex items-center justify-center font-bold">0%</span>
        </div>
       </div>
       <div><label class="block text-sm text-gray-500 mb-1">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label> <button id="board-toggle-btn" onclick="toggleBoardStatus()" class="w-full px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors"> ‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á </button>
       </div>
      </div>
      <div class="mt-4 pt-4 border-t border-gray-200 grid grid-cols-3 gap-4 text-center">
       <div>
        <div class="text-2xl font-bold text-green-600" id="board-sold-count">
         0
        </div>
        <div class="text-sm text-gray-500">
         ‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß
        </div>
       </div>
       <div>
        <div class="text-2xl font-bold text-blue-600" id="board-revenue">
         ‡∏ø0
        </div>
        <div class="text-sm text-gray-500">
         ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö
        </div>
       </div>
       <div>
        <div class="text-2xl font-bold text-gray-600" id="board-remaining">
         0
        </div>
        <div class="text-sm text-gray-500">
         ‡πÄ‡∏´‡∏•‡∏∑‡∏≠
        </div>
       </div>
      </div>
     </div>
     <div class="bg-white/90 backdrop-blur rounded-2xl shadow-xl border border-white/50 p-6">
      <div id="numbers-grid" class="grid grid-cols-10 gap-2"><!-- Numbers will be rendered here -->
      </div>
     </div>
    </div>
   </div><!-- ADMIN LOGIN -->
   <div id="admin-login" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeAdminLogin()"></div>
    <div class="relative bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
     <div class="text-center mb-6">
      <div class="w-20 h-20 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4">
       <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
       </svg>
      </div>
      <h3 class="text-2xl font-bold">Admin Login</h3>
      <p class="text-gray-500 mt-2">‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</p>
     </div>
     <div class="mb-6"><label for="admin-password" class="block text-sm text-gray-500 mb-2">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô Admin</label> <input type="password" id="admin-password" class="w-full px-4 py-3 bg-gray-100 rounded-lg border-0 focus:ring-2 focus:ring-indigo-500" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" onkeypress="if(event.key==='Enter') loginAdmin()">
      <p id="login-error" class="hidden text-red-500 text-sm mt-2">‚ùå ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
     </div>
     <div class="flex gap-3"><button onclick="closeAdminLogin()" class="flex-1 px-4 py-3 bg-gray-200 rounded-lg font-semibold hover:bg-gray-300 transition-colors"> ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å </button> <button onclick="loginAdmin()" class="flex-1 px-4 py-3 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-lg font-semibold hover:shadow-lg transition-all"> ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö </button>
     </div>
    </div>
   </div><!-- ADMIN PANEL -->
   <div id="admin-panel" class="hidden fixed inset-0 z-50">
    <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeAdminPanel()"></div>
    <div class="absolute inset-4 md:inset-8 bg-white rounded-2xl shadow-2xl overflow-hidden flex flex-col">
     <div class="flex items-center justify-between p-4 border-b border-gray-200">
      <h2 class="text-2xl font-bold flex items-center gap-2">
       <svg class="w-7 h-7 text-indigo-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
       </svg> Admin Panel</h2>
      <div class="flex items-center gap-3"><span class="text-sm text-gray-500">user:</span> <span class="px-3 py-1 bg-indigo-100 text-indigo-700 rounded-full font-semibold">hatt2024</span> <button onclick="logoutAdmin()" class="px-4 py-2 bg-red-500 text-white rounded-lg font-semibold hover:bg-red-600 transition-colors flex items-center gap-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
        </svg> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö </button> <button onclick="closeAdminPanel()" class="p-2 hover:bg-gray-100 rounded-lg transition-colors">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg></button>
      </div>
     </div>
     <div class="flex gap-2 p-4 border-b border-gray-200 overflow-x-auto"><button onclick="setAdminTab('dashboard')" class="admin-tab px-4 py-2 rounded-lg font-semibold whitespace-nowrap transition-colors bg-indigo-500 text-white" data-tab="dashboard">üìä ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</button> <button onclick="setAdminTab('bookings')" class="admin-tab px-4 py-2 rounded-lg font-semibold whitespace-nowrap transition-colors bg-gray-100" data-tab="bookings">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</button> <button onclick="setAdminTab('stock')" class="admin-tab px-4 py-2 rounded-lg font-semibold whitespace-nowrap transition-colors bg-gray-100" data-tab="stock">üì¶ ‡∏™‡∏ï‡πá‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button> <button onclick="setAdminTab('summary')" class="admin-tab px-4 py-2 rounded-lg font-semibold whitespace-nowrap transition-colors bg-gray-100" data-tab="summary">üí∞ ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</button>
     </div>
     <div class="flex-1 overflow-auto p-4"><!-- Dashboard Tab -->
      <div id="admin-dashboard" class="admin-content">
       <h3 class="text-2xl font-bold mb-6">üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏° Dashboard</h3>
       <div class="mb-8">
        <h4 class="text-lg font-semibold mb-3">üíé ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡πÄ‡∏ö‡∏≠‡∏£‡πå</h4>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
         <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 border-2 border-indigo-500 p-6 rounded-xl text-center">
          <div class="text-3xl font-bold text-indigo-600" id="dash-total-boards">
           0
          </div>
          <div class="text-sm text-gray-600">
           ‡πÅ‡∏ú‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
          </div>
         </div>
         <div class="bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-500 p-6 rounded-xl text-center">
          <div class="text-3xl font-bold text-green-600" id="dash-total-sold">
           0
          </div>
          <div class="text-sm text-gray-600">
           ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢
          </div>
         </div>
         <div class="bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-500 p-6 rounded-xl text-center">
          <div class="text-3xl font-bold text-blue-600" id="dash-total-revenue">
           ‡∏ø0
          </div>
          <div class="text-sm text-gray-600">
           ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢
          </div>
         </div>
         <div class="bg-gradient-to-br from-purple-50 to-purple-100 border-2 border-purple-500 p-6 rounded-xl text-center">
          <div class="text-3xl font-bold text-purple-600" id="dash-avg-percent">
           0%
          </div>
          <div class="text-sm text-gray-600">
           ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ %
          </div>
         </div>
        </div>
       </div>
       <div class="mb-8">
        <h4 class="text-lg font-semibold mb-3">üì¶ ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h4>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
         <div class="bg-gradient-to-br from-cyan-50 to-cyan-100 border-2 border-cyan-500 p-6 rounded-xl text-center">
          <div class="text-3xl font-bold text-cyan-600" id="dash-total-products">
           0
          </div>
          <div class="text-sm text-gray-600">
           ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
          </div>
         </div>
         <div class="bg-gradient-to-br from-amber-50 to-amber-100 border-2 border-amber-500 p-6 rounded-xl text-center">
          <div class="text-3xl font-bold text-amber-600" id="dash-total-stock">
           0
          </div>
          <div class="text-sm text-gray-600">
           ‡∏™‡∏ï‡πá‡∏≠‡∏Å
          </div>
         </div>
         <div class="bg-gradient-to-br from-lime-50 to-lime-100 border-2 border-lime-500 p-6 rounded-xl text-center">
          <div class="text-3xl font-bold text-lime-600" id="dash-total-stock-sold">
           0
          </div>
          <div class="text-sm text-gray-600">
           ‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß
          </div>
         </div>
         <div class="bg-gradient-to-br from-emerald-50 to-emerald-100 border-2 border-emerald-500 p-6 rounded-xl text-center">
          <div class="text-3xl font-bold text-emerald-600" id="dash-total-stock-profit">
           ‡∏ø0
          </div>
          <div class="text-sm text-gray-600">
           ‡∏Å‡∏≥‡πÑ‡∏£
          </div>
         </div>
        </div>
       </div>
      </div><!-- Bookings Tab -->
      <div id="admin-bookings" class="admin-content hidden">
       <div class="flex flex-wrap gap-4 mb-4"><select id="admin-board-filter" onchange="renderAdminTable()" class="px-4 py-2 bg-gray-100 rounded-lg border-0 focus:ring-2 focus:ring-indigo-500"> <option value="all">‡∏ó‡∏∏‡∏Å‡πÅ‡∏ú‡∏á</option> </select> <button onclick="exportExcel()" class="flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
         </svg> Export Excel </button>
       </div>
       <div class="overflow-x-auto rounded-xl border border-gray-200">
        <table class="w-full">
         <thead class="bg-gray-100">
          <tr>
           <th class="px-4 py-3 text-left font-semibold">‡πÅ‡∏ú‡∏á</th>
           <th class="px-4 py-3 text-left font-semibold">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á</th>
           <th class="px-4 py-3 text-left font-semibold">‡πÄ‡∏•‡∏Ç</th>
           <th class="px-4 py-3 text-left font-semibold">‡∏£‡∏≤‡∏Ñ‡∏≤</th>
           <th class="px-4 py-3 text-left font-semibold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
          </tr>
         </thead>
         <tbody id="admin-table-body" class="divide-y divide-gray-200"><!-- Rows -->
         </tbody>
        </table>
       </div>
      </div><!-- Stock Tab -->
      <div id="admin-stock" class="admin-content hidden">
       <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold">üì¶ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ï‡πá‡∏≠‡∏Å</h3><button onclick="showAddProductModal()" class="px-4 py-2 bg-orange-500 text-white rounded-lg font-semibold hover:bg-orange-600 transition-colors flex items-center gap-2">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
         </svg> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ </button>
       </div>
       <div class="overflow-x-auto rounded-xl border border-gray-200">
        <table class="w-full">
         <thead class="bg-gray-100">
          <tr>
           <th class="px-4 py-3 text-left font-semibold">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
           <th class="px-4 py-3 text-right font-semibold">‡∏ó‡∏∏‡∏ô</th>
           <th class="px-4 py-3 text-right font-semibold">‡∏Ç‡∏≤‡∏¢</th>
           <th class="px-4 py-3 text-center font-semibold">‡∏™‡∏ï‡πá‡∏≠‡∏Å</th>
           <th class="px-4 py-3 text-center font-semibold">‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß</th>
           <th class="px-4 py-3 text-right font-semibold">‡∏Å‡∏≥‡πÑ‡∏£</th>
           <th class="px-4 py-3 text-center font-semibold">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
          </tr>
         </thead>
         <tbody id="admin-stock-table" class="divide-y divide-gray-200"><!-- Rows -->
         </tbody>
        </table>
       </div>
      </div><!-- Summary Tab -->
      <div id="admin-summary" class="admin-content hidden">
       <h3 class="text-2xl font-bold mb-6">üí∞ ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</h3>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-6"><!-- ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö -->
        <div class="bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-500 p-6 rounded-xl">
         <div class="flex items-center gap-3 mb-4">
          <div class="w-12 h-12 bg-green-500 rounded-full flex items-center justify-center">
           <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
           </svg>
          </div>
          <div>
           <h4 class="text-lg font-semibold text-green-700">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h4>
           <p class="text-sm text-gray-600">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</p>
          </div>
         </div>
         <div class="space-y-3">
          <div class="flex justify-between items-center p-3 bg-white rounded-lg"><span class="text-sm text-gray-600">üíé ‡∏Ç‡∏≤‡∏¢‡πÄ‡∏ö‡∏≠‡∏£‡πå</span> <span class="font-bold text-green-600" id="summary-number-income">‡∏ø0</span>
          </div>
          <div class="flex justify-between items-center p-3 bg-white rounded-lg"><span class="text-sm text-gray-600">üì¶ ‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span> <span class="font-bold text-green-600" id="summary-product-revenue">‡∏ø0</span>
          </div>
          <div class="flex justify-between items-center p-3 bg-white rounded-lg border-t-2 border-green-500"><span class="font-semibold">‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</span> <span class="text-xl font-bold text-green-600" id="summary-total-income">‡∏ø0</span>
          </div>
         </div>
        </div><!-- ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ -->
        <div class="bg-gradient-to-br from-red-50 to-rose-50 border-2 border-red-500 p-6 rounded-xl">
         <div class="flex items-center gap-3 mb-4">
          <div class="w-12 h-12 bg-red-500 rounded-full flex items-center justify-center">
           <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4" />
           </svg>
          </div>
          <div>
           <h4 class="text-lg font-semibold text-red-700">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h4>
           <p class="text-sm text-gray-600">‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢</p>
          </div>
         </div>
         <div class="space-y-3">
          <div class="flex justify-between items-center p-3 bg-white rounded-lg"><span class="text-sm text-gray-600">üì¶ ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span> <span class="font-bold text-red-600" id="summary-product-cost">‡∏ø0</span>
          </div>
          <div class="flex justify-between items-center p-3 bg-white rounded-lg"><span class="text-sm text-gray-600">üí∏ ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏∑‡πà‡∏ô‡πÜ</span> <span class="font-bold text-red-600">‡∏ø0</span>
          </div>
          <div class="flex justify-between items-center p-3 bg-white rounded-lg border-t-2 border-red-500"><span class="font-semibold">‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</span> <span class="text-xl font-bold text-red-600" id="summary-total-expense">‡∏ø0</span>
          </div>
         </div>
        </div>
       </div><!-- ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ -->
       <div class="mt-6 bg-gradient-to-br from-blue-50 to-cyan-50 border-4 border-blue-500 p-8 rounded-2xl text-center">
        <h4 class="text-2xl font-bold mb-2 text-blue-700">üí∞ ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</h4>
        <div class="text-5xl font-bold text-blue-600 mb-2" id="summary-net-profit">
         ‡∏ø0
        </div>
        <p class="text-gray-600">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö - ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢ = ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</p>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Modals (Booking, Rename, Delete, Product, Sell) -->
   <div id="booking-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeBookingModal()"></div>
    <div class="relative bg-white rounded-2xl shadow-2xl p-6 w-full max-w-sm">
     <h3 class="text-xl font-bold mb-4">‡∏à‡∏≠‡∏á‡πÄ‡∏•‡∏Ç <span id="modal-number" class="text-indigo-600"></span></h3>
     <div class="mb-4"><label for="booker-name" class="block text-sm text-gray-500 mb-1">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á</label> <input type="text" id="booker-name" class="w-full px-4 py-3 bg-gray-100 rounded-lg border-0 focus:ring-2 focus:ring-indigo-500" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠">
     </div>
     <div class="flex gap-3"><button onclick="closeBookingModal()" class="flex-1 px-4 py-3 bg-gray-200 rounded-lg font-semibold">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button> <button onclick="confirmBooking()" class="flex-1 px-4 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg font-semibold">‡∏à‡∏≠‡∏á</button>
     </div>
    </div>
   </div>
   <div id="rename-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeRenameModal()"></div>
    <div class="relative bg-white rounded-2xl shadow-2xl p-6 w-full max-w-sm">
     <h3 class="text-xl font-bold mb-4">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ú‡∏á</h3>
     <div class="mb-4"><label for="new-board-name" class="block text-sm text-gray-500 mb-1">‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà</label> <input type="text" id="new-board-name" class="w-full px-4 py-3 bg-gray-100 rounded-lg border-0 focus:ring-2 focus:ring-indigo-500">
     </div>
     <div class="flex gap-3"><button onclick="closeRenameModal()" class="flex-1 px-4 py-3 bg-gray-200 rounded-lg font-semibold">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button> <button onclick="confirmRename()" class="flex-1 px-4 py-3 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-lg font-semibold">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
     </div>
    </div>
   </div>
   <div id="delete-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeDeleteModal()"></div>
    <div class="relative bg-white rounded-2xl shadow-2xl p-6 w-full max-w-sm">
     <h3 class="text-xl font-bold mb-4 text-red-500">‚ö†Ô∏è ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡πÅ‡∏ú‡∏á</h3>
     <p class="text-gray-600 mb-4">‡∏•‡∏ö‡πÅ‡∏ú‡∏á‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</p>
     <div class="flex gap-3"><button onclick="closeDeleteModal()" class="flex-1 px-4 py-3 bg-gray-200 rounded-lg font-semibold">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button> <button onclick="confirmDelete()" class="flex-1 px-4 py-3 bg-red-500 text-white rounded-lg font-semibold">‡∏•‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£</button>
     </div>
    </div>
   </div>
   <div id="product-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeProductModal()"></div>
    <div class="relative bg-white rounded-2xl shadow-2xl p-6 w-full max-w-md">
     <h3 id="product-modal-title" class="text-xl font-bold mb-4">üì¶ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
     <div class="space-y-4">
      <div><label for="product-name" class="block text-sm text-gray-500 mb-1">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</label> <input type="text" id="product-name" class="w-full px-4 py-3 bg-gray-100 rounded-lg border-0 focus:ring-2 focus:ring-orange-500">
      </div>
      <div class="grid grid-cols-2 gap-4">
       <div><label for="product-buy-price" class="block text-sm text-gray-500 mb-1">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏∏‡∏ô</label> <input type="number" id="product-buy-price" class="w-full px-4 py-3 bg-gray-100 rounded-lg border-0 focus:ring-2 focus:ring-orange-500" min="0">
       </div>
       <div><label for="product-sell-price" class="block text-sm text-gray-500 mb-1">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢</label> <input type="number" id="product-sell-price" class="w-full px-4 py-3 bg-gray-100 rounded-lg border-0 focus:ring-2 focus:ring-orange-500" min="0">
       </div>
      </div>
      <div><label for="product-quantity" class="block text-sm text-gray-500 mb-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏™‡∏ï‡πá‡∏≠‡∏Å</label> <input type="number" id="product-quantity" class="w-full px-4 py-3 bg-gray-100 rounded-lg border-0 focus:ring-2 focus:ring-orange-500" min="0">
      </div>
     </div>
     <div class="flex gap-3 mt-6"><button onclick="closeProductModal()" class="flex-1 px-4 py-3 bg-gray-200 rounded-lg font-semibold">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button> <button onclick="saveProduct()" class="flex-1 px-4 py-3 bg-gradient-to-r from-orange-500 to-pink-600 text-white rounded-lg font-semibold">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
     </div>
    </div>
   </div>
   <div id="sell-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="closeSellModal()"></div>
    <div class="relative bg-white rounded-2xl shadow-2xl p-6 w-full max-w-sm">
     <h3 class="text-xl font-bold mb-4">üí∞ ‡∏Ç‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
     <div class="mb-4 p-3 bg-orange-50 rounded-lg">
      <p class="text-sm text-gray-600">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: <span id="sell-product-name" class="font-semibold text-orange-600"></span></p>
      <p class="text-sm text-gray-600">‡∏™‡∏ï‡πá‡∏≠‡∏Å: <span id="sell-product-stock" class="font-semibold text-amber-600"></span></p>
     </div>
     <div class="mb-4"><label for="sell-quantity" class="block text-sm text-gray-500 mb-1">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢</label> <input type="number" id="sell-quantity" class="w-full px-4 py-3 bg-gray-100 rounded-lg border-0 focus:ring-2 focus:ring-green-500" min="1">
     </div>
     <div class="flex gap-3"><button onclick="closeSellModal()" class="flex-1 px-4 py-3 bg-gray-200 rounded-lg font-semibold">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button> <button onclick="confirmSell()" class="flex-1 px-4 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg font-semibold">‡∏Ç‡∏≤‡∏¢</button>
     </div>
    </div>
   </div>
  </div>
  <script>
    // FIREBASE CONFIG
    const FIREBASE_URL = 'https://excel-server-9b6e2-default-rtdb.asia-southeast1.firebasedatabase.app';
    
    // STATE
    let boards = [];
    let bookings = [];
    let products = [];
    let draws = []; // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
    let currentBoardId = null;
    let selectedNumber = null;
    let targetBoardId = null;
    let editingProduct = null;
    let sellingProductId = null; // ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ID ‡πÅ‡∏ó‡∏ô
    let activeMenu = null;
    let currentAdminTab = 'dashboard';
    let isAdminLoggedIn = false;
    let isLoading = true;
    
    const ADMIN_PASSWORD = 'hatt2024';
    
    // FIREBASE FUNCTIONS
    async function loadDataFromFirebase() {
      try {
        const [boardsRes, bookingsRes, productsRes] = await Promise.all([
          fetch(`${FIREBASE_URL}/boards.json`),
          fetch(`${FIREBASE_URL}/bookings.json`),
          fetch(`${FIREBASE_URL}/products.json`)
        ]);
        
        const boardsData = await boardsRes.json();
        const bookingsData = await bookingsRes.json();
        const productsData = await productsRes.json();
        
        boards = boardsData ? Object.values(boardsData) : [];
        bookings = bookingsData ? Object.values(bookingsData) : [];
        products = productsData ? Object.values(productsData) : [];
        
        isLoading = false;
        document.getElementById('loading-screen').classList.add('hidden');
        
        renderBoards();
        updateSummaryStats();
        renderProducts();
        updateAdminBoardFilter();
        
        showToast('‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üéâ');
      } catch (error) {
        console.error('Error loading data:', error);
        isLoading = false;
        document.getElementById('loading-screen').classList.add('hidden');
        showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
      }
    }
    
    async function saveData() {
      if (isLoading) return;
      try {
        const boardsObj = {};
        const bookingsObj = {};
        const productsObj = {};
        
        boards.forEach(b => boardsObj[b.id] = b);
        bookings.forEach(b => bookingsObj[b.id] = b);
        products.forEach(p => productsObj[p.id] = p);
        
        await Promise.all([
          fetch(`${FIREBASE_URL}/boards.json`, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(boardsObj)
          }),
          fetch(`${FIREBASE_URL}/bookings.json`, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(bookingsObj)
          }),
          fetch(`${FIREBASE_URL}/products.json`, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(productsObj)
          })
        ]);
        
        console.log(' ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', { boards: boards.length, bookings: bookings.length, products: products.length });
      } catch (error) {
        console.error('Error saving data:', error);
        showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å', 'error');
      }
    }
    
    // AUDIO
    const tickSound = {
      play: () => {
        try {
          const ctx = new (window.AudioContext || window.webkitAudioContext)();
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.frequency.value = 800;
          osc.type = 'sine';
          gain.gain.setValueAtTime(0.3, ctx.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
          osc.start(ctx.currentTime);
          osc.stop(ctx.currentTime + 0.1);
        } catch (e) {}
      }
    };
    
    // CLOCK
    function updateClock() {
      const now = new Date();
      const timeStr = now.toLocaleTimeString('th-TH', { hour12: false });
      const clockEl = document.getElementById('clock');
      const boardClockEl = document.getElementById('board-clock');
      if (clockEl) clockEl.textContent = timeStr;
      if (boardClockEl) boardClockEl.textContent = timeStr;
    }
    setInterval(updateClock, 1000);
    updateClock();
    
    // DARK MODE
    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
      const isDark = document.body.classList.contains('dark-mode');
      localStorage.setItem('darkMode', isDark);
      
      // Toggle icons
      document.getElementById('dark-icon').classList.toggle('hidden', isDark);
      document.getElementById('light-icon').classList.toggle('hidden', !isDark);
    }
    
    // Load dark mode preference
    if (localStorage.getItem('darkMode') === 'true') {
      document.body.classList.add('dark-mode');
      document.getElementById('dark-icon').classList.add('hidden');
      document.getElementById('light-icon').classList.remove('hidden');
    }
    
    // TOAST
    function showToast(message, type = 'success') {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');
      const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500';
      toast.className = `toast px-6 py-3 ${bgColor} text-white rounded-xl shadow-lg font-semibold`;
      toast.textContent = message;
      container.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }
    
    // REFRESH FUNCTIONS
    async function refreshBoards() {
      showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏≠‡∏£‡πå...', 'info');
      await loadDataFromFirebase();
      showToast('‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üîÑ');
    }
    
    async function refreshProducts() {
      showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤...', 'info');
      await loadDataFromFirebase();
      showToast('‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üîÑ');
    }
    
    // ADMIN
    function showAdminLogin() {
      if (isAdminLoggedIn) {
        showAdminPanel();
      } else {
        document.getElementById('admin-login').classList.remove('hidden');
        document.getElementById('admin-password').focus();
        document.getElementById('login-error').classList.add('hidden');
      }
    }
    
    function closeAdminLogin() {
      document.getElementById('admin-login').classList.add('hidden');
      document.getElementById('admin-password').value = '';
      document.getElementById('login-error').classList.add('hidden');
    }
    
    function loginAdmin() {
      const password = document.getElementById('admin-password').value;
      if (password === ADMIN_PASSWORD) {
        isAdminLoggedIn = true;
        closeAdminLogin();
        showAdminPanel();
        showToast('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
      } else {
        document.getElementById('login-error').classList.remove('hidden');
        document.getElementById('admin-password').value = '';
        document.getElementById('admin-password').focus();
      }
    }
    
    function logoutAdmin() {
      isAdminLoggedIn = false;
      closeAdminPanel();
      showToast('‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß');
    }
    
    function showAdminPanel() {
      document.getElementById('admin-panel').classList.remove('hidden');
      setAdminTab('dashboard');
    }
    
    function closeAdminPanel() {
      document.getElementById('admin-panel').classList.add('hidden');
    }
    
    function setAdminTab(tab) {
      currentAdminTab = tab;
      document.querySelectorAll('.admin-tab').forEach(btn => {
        if (btn.dataset.tab === tab) {
          btn.className = 'admin-tab px-4 py-2 rounded-lg font-semibold whitespace-nowrap transition-colors bg-indigo-500 text-white';
        } else {
          btn.className = 'admin-tab px-4 py-2 rounded-lg font-semibold whitespace-nowrap transition-colors bg-gray-100 hover:bg-gray-200';
        }
      });
      document.querySelectorAll('.admin-content').forEach(el => el.classList.add('hidden'));
      document.getElementById(`admin-${tab}`).classList.remove('hidden');
      if (tab === 'bookings') renderAdminTable();
      if (tab === 'stock') renderAdminStockTable();
      if (tab === 'dashboard') renderDashboard();
      if (tab === 'summary') renderSummaryTab();
    }
    
    // HELPERS
    function generateId() {
      return Date.now().toString(36) + Math.random().toString(36).substr(2);
    }
    
    function getBoardBookings(boardId) {
      return bookings.filter(b => b.board_id === boardId);
    }
    
    function getBookingByNumber(boardId, number) {
      return bookings.find(b => b.board_id === boardId && b.number === number);
    }
    
    // BOARDS
    async function addNewBoard() {
      const newBoard = {
        id: generateId(),
        board_id: generateId(),
        board_name: `‡πÅ‡∏ú‡∏á‡∏ó‡∏µ‡πà ${boards.length + 1}`,
        draw_date: new Date().toISOString().split('T')[0],
        price_per_number: 100,
        is_closed: false,
        created_at: new Date().toISOString()
      };
      boards.push(newBoard);
      await saveData();
      renderBoards();
      updateSummaryStats();
      showToast('‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ú‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
    }
    
    function openBoardMenu(event, boardId) {
      event.stopPropagation();
      closeAllMenus();
      const menu = document.getElementById(`menu-${boardId}`);
      if (menu) {
        menu.classList.remove('hidden');
        activeMenu = boardId;
      }
    }
    
    function closeAllMenus() {
      document.querySelectorAll('[id^="menu-"]').forEach(el => el.classList.add('hidden'));
      activeMenu = null;
    }
    
    function openRenameModal(boardId) {
      closeAllMenus();
      targetBoardId = boardId;
      const board = boards.find(b => b.board_id === boardId);
      if (board) {
        document.getElementById('new-board-name').value = board.board_name;
        document.getElementById('rename-modal').classList.remove('hidden');
      }
    }
    
    function closeRenameModal() {
      document.getElementById('rename-modal').classList.add('hidden');
      targetBoardId = null;
    }
    
    async function confirmRename() {
      const newName = document.getElementById('new-board-name').value.trim();
      if (!newName || !targetBoardId) return;
      const board = boards.find(b => b.board_id === targetBoardId);
      if (board) {
        board.board_name = newName;
        await saveData();
        renderBoards();
        showToast('‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
      }
      closeRenameModal();
    }
    
    function openDeleteModal(boardId) {
      closeAllMenus();
      targetBoardId = boardId;
      document.getElementById('delete-modal').classList.remove('hidden');
    }
    
    function closeDeleteModal() {
      document.getElementById('delete-modal').classList.add('hidden');
      targetBoardId = null;
    }
    
    async function confirmDelete() {
      if (!targetBoardId) return;
      bookings = bookings.filter(b => b.board_id !== targetBoardId);
      boards = boards.filter(b => b.board_id !== targetBoardId);
      await saveData();
      renderBoards();
      updateSummaryStats();
      showToast('‡∏•‡∏ö‡πÅ‡∏ú‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
      closeDeleteModal();
    }
    
    // BOARD PAGE
    function openBoard(boardId) {
      currentBoardId = boardId;
      document.getElementById('home-page').classList.add('hidden');
      document.getElementById('board-page').classList.remove('hidden');
      renderBoardPage();
    }
    
    function goHome() {
      currentBoardId = null;
      document.getElementById('board-page').classList.add('hidden');
      document.getElementById('home-page').classList.remove('hidden');
    }
    
    async function refreshBoard() {
      showToast('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä...', 'info');
      await loadDataFromFirebase();
      renderBoardPage();
      showToast('‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üîÑ');
    }
    
    function renderBoardPage() {
      if (!currentBoardId) return;
      const board = boards.find(b => b.board_id === currentBoardId);
      if (!board) return;
      const boardBookings = getBoardBookings(currentBoardId);
      const soldCount = boardBookings.length;
      const percent = Math.round((soldCount / 100) * 100);
      const revenue = soldCount * board.price_per_number;
      
      document.getElementById('board-name-input').value = board.board_name;
      document.getElementById('board-date-input').value = board.draw_date || '';
      document.getElementById('board-price-input').value = board.price_per_number;
      document.getElementById('board-progress').style.width = `${percent}%`;
      document.getElementById('board-percent').textContent = `${percent}%`;
      document.getElementById('board-sold-count').textContent = soldCount;
      document.getElementById('board-revenue').textContent = `‡∏ø${revenue.toLocaleString()}`;
      document.getElementById('board-remaining').textContent = 100 - soldCount;
      
      const toggleBtn = document.getElementById('board-toggle-btn');
      if (board.is_closed) {
        toggleBtn.textContent = '‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß';
        toggleBtn.className = 'w-full px-4 py-2 bg-red-500 text-white rounded-lg font-semibold hover:bg-red-600 transition-colors';
      } else {
        toggleBtn.textContent = '‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á';
        toggleBtn.className = 'w-full px-4 py-2 bg-green-500 text-white rounded-lg font-semibold hover:bg-green-600 transition-colors';
      }
      
      renderNumbersGrid(board, boardBookings);
      document.getElementById('board-name-input').onchange = (e) => updateBoardField('board_name', e.target.value);
      document.getElementById('board-date-input').onchange = (e) => updateBoardField('draw_date', e.target.value);
      document.getElementById('board-price-input').onchange = (e) => updateBoardField('price_per_number', parseInt(e.target.value) || 0);
    }
    
    async function updateBoardField(field, value) {
      const board = boards.find(b => b.board_id === currentBoardId);
      if (board) {
        board[field] = value;
        await saveData();
      }
    }
    
    async function toggleBoardStatus() {
      const board = boards.find(b => b.board_id === currentBoardId);
      if (board) {
        board.is_closed = !board.is_closed;
        await saveData();
        renderBoardPage();
        showToast(board.is_closed ? '‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß' : '‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß');
      }
    }
    
    function renderNumbersGrid(board, boardBookings) {
      const grid = document.getElementById('numbers-grid');
      grid.innerHTML = '';
      for (let i = 0; i < 100; i++) {
        const numStr = i.toString().padStart(2, '0');
        const booking = boardBookings.find(b => b.number === i);
        const cell = document.createElement('div');
        cell.className = `number-cell relative aspect-square flex items-center justify-center rounded-lg font-bold text-lg cursor-pointer ${
          booking 
            ? 'bg-gradient-to-br from-green-400 to-emerald-500 text-white shadow-lg' 
            : 'bg-gray-100 hover:bg-gray-200'
        }`;
        cell.textContent = numStr;
        if (booking) {
          cell.onclick = () => {
            if (!board.is_closed) {
              cancelBooking(booking);
            }
          };
        } else {
          cell.onclick = () => {
            if (!board.is_closed) {
              openBookingModal(i);
            } else {
              showToast('‡πÅ‡∏ú‡∏á‡∏ô‡∏µ‡πâ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß', 'error');
            }
          };
        }
        grid.appendChild(cell);
      }
    }
    
    function openBookingModal(number) {
      selectedNumber = number;
      document.getElementById('modal-number').textContent = number.toString().padStart(2, '0');
      document.getElementById('booker-name').value = '';
      document.getElementById('booking-modal').classList.remove('hidden');
      document.getElementById('booker-name').focus();
    }
    
    function closeBookingModal() {
      document.getElementById('booking-modal').classList.add('hidden');
      selectedNumber = null;
    }
    
    async function confirmBooking() {
      const name = document.getElementById('booker-name').value.trim();
      if (!name || selectedNumber === null || !currentBoardId) return;
      const existing = getBookingByNumber(currentBoardId, selectedNumber);
      if (existing) {
        showToast('‡πÄ‡∏•‡∏Ç‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏à‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß', 'error');
        closeBookingModal();
        return;
      }
      const booking = {
        id: generateId(),
        board_id: currentBoardId,
        number: selectedNumber,
        booked_by: name,
        booked_at: new Date().toISOString()
      };
      bookings.push(booking);
      await saveData();
      renderBoardPage();
      updateSummaryStats();
      tickSound.play();
      showToast('‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üéâ');
      setTimeout(() => {
        const cells = document.querySelectorAll('.number-cell');
        if (cells[selectedNumber]) {
          cells[selectedNumber].classList.add('glow-animation');
        }
      }, 100);
      closeBookingModal();
    }
    
    async function cancelBooking(booking) {
      const confirmDiv = document.createElement('div');
      confirmDiv.className = 'fixed inset-0 z-50 flex items-center justify-center p-4';
      confirmDiv.innerHTML = `
        <div class="absolute inset-0 bg-black/50 backdrop-blur-sm"></div>
        <div class="relative bg-white rounded-2xl shadow-2xl p-6 w-full max-w-sm">
          <h3 class="text-xl font-bold mb-4 text-orange-500">‚ö†Ô∏è ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡∏≠‡∏á</h3>
          <p class="text-gray-600 mb-2">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÄ‡∏•‡∏Ç <span class="font-bold text-indigo-600">${booking.number.toString().padStart(2, '0')}</span></p>
          <p class="text-gray-600 mb-4">‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á: <span class="font-semibold">${booking.booked_by}</span></p>
          <p class="text-sm text-red-500 mb-4">‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°?</p>
          <div class="flex gap-3">
            <button id="cancel-cancel-booking" class="flex-1 px-4 py-3 bg-gray-200 rounded-lg font-semibold hover:bg-gray-300 transition-colors">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            <button id="confirm-cancel-booking" class="flex-1 px-4 py-3 bg-orange-500 text-white rounded-lg font-semibold hover:bg-orange-600 transition-colors">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
          </div>
        </div>
      `;
      document.body.appendChild(confirmDiv);
      
      document.getElementById('cancel-cancel-booking').onclick = () => confirmDiv.remove();
      document.getElementById('confirm-cancel-booking').onclick = async () => {
        bookings = bookings.filter(b => b.id !== booking.id);
        await saveData();
        renderBoardPage();
        updateSummaryStats();
        showToast('‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        confirmDiv.remove();
      };
    }
    
    // RENDER BOARDS
    function renderBoards() {
      const grid = document.getElementById('boards-grid');
      const emptyState = document.getElementById('empty-state');
      if (boards.length === 0) {
        grid.innerHTML = '';
        emptyState.style.display = 'block';
        return;
      }
      emptyState.style.display = 'none';
      grid.innerHTML = '';
      boards.sort((a, b) => new Date(a.created_at) - new Date(b.created_at));
      boards.forEach(board => {
        const boardBookings = getBoardBookings(board.board_id);
        const soldCount = boardBookings.length;
        const percent = Math.round((soldCount / 100) * 100);
        const revenue = soldCount * board.price_per_number;
        const card = document.createElement('div');
        card.className = 'board-card bg-white rounded-2xl shadow-xl border-2 border-indigo-200 overflow-hidden cursor-pointer';
        card.onclick = () => openBoard(board.board_id);
        card.innerHTML = `
          <div class="relative p-5">
            <button onclick="openBoardMenu(event, '${board.board_id}')" class="absolute top-3 right-3 p-2 hover:bg-gray-100 rounded-lg transition-colors z-10">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"/>
              </svg>
            </button>
            <div id="menu-${board.board_id}" class="hidden absolute top-12 right-3 bg-white rounded-xl shadow-xl border border-gray-200 overflow-hidden z-20">
              <button onclick="event.stopPropagation(); openRenameModal('${board.board_id}')" class="w-full px-4 py-3 text-left hover:bg-gray-100 flex items-center gap-2">
                <svg class="w-5 h-5 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/>
                </svg>
                ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠
              </button>
              <button onclick="event.stopPropagation(); openDeleteModal('${board.board_id}')" class="w-full px-4 py-3 text-left hover:bg-gray-100 flex items-center gap-2 text-red-500">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                </svg>
                ‡∏•‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£
              </button>
            </div>
            <div class="mb-4">
              <h3 class="text-xl font-bold text-gray-800 mb-1">${board.board_name}</h3>
              <p class="text-sm text-gray-500">
                üìÖ ${board.draw_date ? new Date(board.draw_date).toLocaleDateString('th-TH') : '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}
              </p>
            </div>
            <div class="mb-4">
              <div class="flex justify-between text-sm mb-1">
                <span class="text-gray-500">‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß</span>
                <span class="font-semibold">${percent}%</span>
              </div>
              <div class="h-3 bg-gray-200 rounded-full overflow-hidden">
                <div class="h-full bg-gradient-to-r from-green-400 to-emerald-500 rounded-full transition-all duration-500" style="width: ${percent}%"></div>
              </div>
            </div>
            <div class="grid grid-cols-2 gap-4">
              <div class="text-center p-3 bg-gray-100 rounded-xl">
                <div class="text-lg font-bold text-green-600">${soldCount}/100</div>
                <div class="text-xs text-gray-500">‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß</div>
              </div>
              <div class="text-center p-3 bg-gray-100 rounded-xl">
                <div class="text-lg font-bold text-blue-600">‡∏ø${revenue.toLocaleString()}</div>
                <div class="text-xs text-gray-500">‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢</div>
              </div>
            </div>
            <div class="mt-4">
              ${board.is_closed 
                ? '<span class="px-3 py-1 bg-red-100 text-red-600 rounded-full text-sm font-semibold">üîí ‡∏õ‡∏¥‡∏î</span>'
                : '<span class="px-3 py-1 bg-green-100 text-green-600 rounded-full text-sm font-semibold">‚úÖ ‡πÄ‡∏õ‡∏¥‡∏î</span>'
              }
            </div>
          </div>
        `;
        grid.appendChild(card);
      });
    }
    
    function updateSummaryStats() {
      // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ç‡∏≤‡∏¢‡πÄ‡∏ö‡∏≠‡∏£‡πå
      document.getElementById('total-boards').textContent = boards.length;
      document.getElementById('total-sold').textContent = bookings.length;
      let totalRevenue = 0;
      let totalPercent = 0;
      boards.forEach(board => {
        const boardBookings = getBoardBookings(board.board_id);
        totalRevenue += boardBookings.length * board.price_per_number;
        totalPercent += (boardBookings.length / 100) * 100;
      });
      document.getElementById('total-revenue').textContent = `‡∏ø${Math.round(totalRevenue).toLocaleString()}`;
      document.getElementById('avg-percent').textContent = boards.length > 0 ? `${Math.round(totalPercent / boards.length)}%` : '0%';
      
      // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
      const totalProducts = products.length;
      const totalStock = products.reduce((sum, p) => sum + (Number(p.stock_quantity) || 0), 0);
      const totalStockSold = products.reduce((sum, p) => sum + (Number(p.sold_quantity) || 0), 0);
      const totalStockProfit = products.reduce((sum, p) => {
        const profit = ((Number(p.sell_price) || 0) - (Number(p.buy_price) || 0)) * (Number(p.sold_quantity) || 0);
        return sum + profit;
      }, 0);
      
      document.getElementById('total-products').textContent = totalProducts;
      document.getElementById('total-stock').textContent = Math.round(totalStock);
      document.getElementById('total-stock-sold').textContent = Math.round(totalStockSold);
      document.getElementById('total-stock-profit').textContent = `‡∏ø${Math.round(totalStockProfit).toLocaleString()}`;
    }
    
    // PRODUCTS
    function showAddProductModal() {
      editingProduct = null;
      document.getElementById('product-modal-title').textContent = 'üì¶ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤';
      document.getElementById('product-name').value = '';
      document.getElementById('product-buy-price').value = '';
      document.getElementById('product-sell-price').value = '';
      document.getElementById('product-quantity').value = '';
      document.getElementById('product-modal').classList.remove('hidden');
    }
    
    function showEditProductModal(product) {
      editingProduct = product;
      document.getElementById('product-modal-title').textContent = '‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤';
      document.getElementById('product-name').value = product.product_name;
      document.getElementById('product-buy-price').value = product.buy_price;
      document.getElementById('product-sell-price').value = product.sell_price;
      document.getElementById('product-quantity').value = product.stock_quantity;
      document.getElementById('product-modal').classList.remove('hidden');
    }
    
    function closeProductModal() {
      document.getElementById('product-modal').classList.add('hidden');
      editingProduct = null;
    }
    
    async function saveProduct() {
      const name = document.getElementById('product-name').value.trim();
      const buyPrice = Number(document.getElementById('product-buy-price').value) || 0;
      const sellPrice = Number(document.getElementById('product-sell-price').value) || 0;
      const quantity = Number(document.getElementById('product-quantity').value) || 0;
      
      if (!name) {
        showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤', 'error');
        return;
      }
      
      if (editingProduct) {
        // ‡∏´‡∏≤ product index ‡∏à‡∏≤‡∏Å ID
        const productIndex = products.findIndex(p => p.id === editingProduct.id);
        if (productIndex !== -1) {
          products[productIndex].product_name = name;
          products[productIndex].buy_price = buyPrice;
          products[productIndex].sell_price = sellPrice;
          products[productIndex].stock_quantity = quantity;
          
          await saveData();
          renderProducts();
          updateSummaryStats();
          showToast('‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
        }
      } else {
        const newProduct = {
          id: generateId(),
          product_name: name,
          buy_price: buyPrice,
          sell_price: sellPrice,
          stock_quantity: quantity,
          sold_quantity: 0,
          created_at: new Date().toISOString()
        };
        
        products.push(newProduct);
        await saveData();
        renderProducts();
        updateSummaryStats();
        showToast('‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üì¶');
      }
      
      closeProductModal();
    }
    
    function showSellModal(product) {
      sellingProductId = product.id; // ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ID
      document.getElementById('sell-product-name').textContent = product.product_name;
      document.getElementById('sell-product-stock').textContent = product.stock_quantity;
      document.getElementById('sell-quantity').value = '';
      document.getElementById('sell-quantity').max = product.stock_quantity;
      document.getElementById('sell-modal').classList.remove('hidden');
      document.getElementById('sell-quantity').focus();
    }
    
    function closeSellModal() {
      document.getElementById('sell-modal').classList.add('hidden');
      sellingProductId = null;
    }
    
    async function confirmSell() {
      if (!sellingProductId) return;
      
      const quantity = Number(document.getElementById('sell-quantity').value) || 0;
      if (quantity <= 0) {
        showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢', 'error');
        return;
      }
      
      // ‡∏´‡∏≤ product ‡∏à‡∏≤‡∏Å ID ‡πÉ‡∏ô array
      const productIndex = products.findIndex(p => p.id === sellingProductId);
      if (productIndex === -1) {
        showToast('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤', 'error');
        return;
      }
      
      const product = products[productIndex];
      const currentStock = Number(product.stock_quantity) || 0;
      const currentSold = Number(product.sold_quantity) || 0;
      
      if (quantity > currentStock) {
        showToast('‡∏™‡∏ï‡πá‡∏≠‡∏Å‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠!', 'error');
        return;
      }
      
      console.log('üí∞ ‡∏Å‡πà‡∏≠‡∏ô‡∏Ç‡∏≤‡∏¢:', { 
        product: product.product_name,
        stock: currentStock, 
        sold: currentSold,
        sellQty: quantity
      });
      
      // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô array ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
      products[productIndex].stock_quantity = currentStock - quantity;
      products[productIndex].sold_quantity = currentSold + quantity;
      
      console.log('üí∞ ‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≤‡∏¢:', { 
        product: products[productIndex].product_name,
        stock: products[productIndex].stock_quantity, 
        sold: products[productIndex].sold_quantity
      });
      
      // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Firebase
      await saveData();
      
      // ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä UI
      renderProducts();
      updateSummaryStats();
      
      showToast(`‡∏Ç‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ${quantity} ‡∏ä‡∏¥‡πâ‡∏ô üí∞`);
      closeSellModal();
    }
    
    async function deleteProduct(product) {
      const confirmDiv = document.createElement('div');
      confirmDiv.className = 'fixed inset-0 z-50 flex items-center justify-center p-4';
      confirmDiv.innerHTML = `
        <div class="absolute inset-0 bg-black/50 backdrop-blur-sm"></div>
        <div class="relative bg-white rounded-2xl shadow-2xl p-6 w-full max-w-sm">
          <h3 class="text-xl font-bold mb-4 text-red-500">‚ö†Ô∏è ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
          <p class="text-gray-600 mb-4">‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ "${product.product_name}" ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?</p>
          <div class="flex gap-3">
            <button id="cancel-delete-product" class="flex-1 px-4 py-3 bg-gray-200 rounded-lg font-semibold">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            <button id="confirm-delete-product" class="flex-1 px-4 py-3 bg-red-500 text-white rounded-lg font-semibold">‡∏•‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£</button>
          </div>
        </div>
      `;
      document.body.appendChild(confirmDiv);
      document.getElementById('cancel-delete-product').onclick = () => confirmDiv.remove();
      document.getElementById('confirm-delete-product').onclick = async () => {
        products = products.filter(p => p.id !== product.id);
        await saveData();
        renderProducts();
        updateSummaryStats();
        showToast('‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        confirmDiv.remove();
      };
    }
    
    function renderProducts() {
      const list = document.getElementById('products-list');
      const empty = document.getElementById('products-empty');
      if (products.length === 0) {
        list.innerHTML = '';
        empty.style.display = 'block';
        return;
      }
      empty.style.display = 'none';
      list.innerHTML = products.map(product => {
        const sellPrice = Number(product.sell_price) || 0;
        const buyPrice = Number(product.buy_price) || 0;
        const sold = Number(product.sold_quantity) || 0;
        const stock = Number(product.stock_quantity) || 0;
        const profit = (sellPrice - buyPrice) * sold;
        
        return `
          <div class="bg-white p-4 rounded-xl flex items-center justify-between shadow-lg border-2 border-orange-200">
            <div class="flex-1">
              <h4 class="font-semibold text-lg">${product.product_name}</h4>
              <div class="grid grid-cols-3 gap-2 mt-2 text-sm">
                <div><span class="text-gray-500">‡∏ó‡∏∏‡∏ô:</span> <span class="font-semibold text-red-600">‡∏ø${Math.round(buyPrice).toLocaleString()}</span></div>
                <div><span class="text-gray-500">‡∏Ç‡∏≤‡∏¢:</span> <span class="font-semibold text-green-600">‡∏ø${Math.round(sellPrice).toLocaleString()}</span></div>
                <div><span class="text-gray-500">‡∏Å‡∏≥‡πÑ‡∏£:</span> <span class="font-semibold text-emerald-600">‡∏ø${Math.round(profit).toLocaleString()}</span></div>
              </div>
              <div class="mt-2 flex gap-4 text-sm">
                <span class="px-2 py-1 bg-amber-100 text-amber-600 rounded-lg font-semibold">‡∏™‡∏ï‡πá‡∏≠‡∏Å: ${Math.round(stock)}</span>
                <span class="px-2 py-1 bg-green-100 text-green-600 rounded-lg font-semibold">‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß: ${Math.round(sold)}</span>
              </div>
            </div>
            <div class="flex gap-2 ml-4">
              <button onclick='showSellModal(${JSON.stringify(product).replace(/'/g, "&apos;")})' ${stock <= 0 ? 'disabled' : ''} class="px-3 py-2 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg font-semibold hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed">üí∞ ‡∏Ç‡∏≤‡∏¢</button>
              <button onclick='showEditProductModal(${JSON.stringify(product).replace(/'/g, "&apos;")})' class="p-2 hover:bg-gray-200 rounded-lg transition-colors">
                <svg class="w-5 h-5 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/>
                </svg>
              </button>
              <button onclick='deleteProduct(${JSON.stringify(product).replace(/'/g, "&apos;")})' class="p-2 hover:bg-red-100 rounded-lg transition-colors text-red-500">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                </svg>
              </button>
            </div>
          </div>
        `;
      }).join('');
    }
    
    // DASHBOARD
    function renderDashboard() {
      let totalRevenue = 0;
      let totalPercent = 0;
      boards.forEach(board => {
        const boardBookings = getBoardBookings(board.board_id);
        totalRevenue += boardBookings.length * board.price_per_number;
        totalPercent += (boardBookings.length / 100) * 100;
      });
      document.getElementById('dash-total-boards').textContent = boards.length;
      document.getElementById('dash-total-sold').textContent = bookings.length;
      document.getElementById('dash-total-revenue').textContent = `‡∏ø${Math.round(totalRevenue).toLocaleString()}`;
      document.getElementById('dash-avg-percent').textContent = boards.length > 0 ? `${Math.round(totalPercent / boards.length)}%` : '0%';
      
      const totalProducts = products.length;
      const totalStock = products.reduce((sum, p) => sum + (Number(p.stock_quantity) || 0), 0);
      const totalStockSold = products.reduce((sum, p) => sum + (Number(p.sold_quantity) || 0), 0);
      const totalStockProfit = products.reduce((sum, p) => {
        const profit = ((Number(p.sell_price) || 0) - (Number(p.buy_price) || 0)) * (Number(p.sold_quantity) || 0);
        return sum + profit;
      }, 0);
      
      document.getElementById('dash-total-products').textContent = totalProducts;
      document.getElementById('dash-total-stock').textContent = Math.round(totalStock);
      document.getElementById('dash-total-stock-sold').textContent = Math.round(totalStockSold);
      document.getElementById('dash-total-stock-profit').textContent = `‡∏ø${Math.round(totalStockProfit).toLocaleString()}`;
    }
    
    function renderSummaryTab() {
      let numberIncome = 0;
      boards.forEach(board => {
        const boardBookings = getBoardBookings(board.board_id);
        numberIncome += boardBookings.length * board.price_per_number;
      });
      
      const productRevenue = products.reduce((sum, p) => {
        const revenue = (Number(p.sell_price) || 0) * (Number(p.sold_quantity) || 0);
        return sum + revenue;
      }, 0);
      
      const productCost = products.reduce((sum, p) => {
        const cost = (Number(p.buy_price) || 0) * (Number(p.sold_quantity) || 0);
        return sum + cost;
      }, 0);
      
      const totalIncome = numberIncome + productRevenue;
      const totalExpense = productCost;
      const netProfit = totalIncome - totalExpense;
      
      const el = (id, text) => { const e = document.getElementById(id); if (e) e.textContent = text; };
      el('summary-number-income', `‡∏ø${Math.round(numberIncome).toLocaleString()}`);
      el('summary-product-revenue', `‡∏ø${Math.round(productRevenue).toLocaleString()}`);
      el('summary-total-income', `‡∏ø${Math.round(totalIncome).toLocaleString()}`);
      el('summary-product-cost', `‡∏ø${Math.round(productCost).toLocaleString()}`);
      el('summary-total-expense', `‡∏ø${Math.round(totalExpense).toLocaleString()}`);
      el('summary-net-profit', `‡∏ø${Math.round(netProfit).toLocaleString()}`);
    }
    
    function updateAdminBoardFilter() {
      const select = document.getElementById('admin-board-filter');
      if (!select) return;
      const currentValue = select.value;
      select.innerHTML = '<option value="all">‡∏ó‡∏∏‡∏Å‡πÅ‡∏ú‡∏á</option>';
      boards.forEach(board => {
        const option = document.createElement('option');
        option.value = board.board_id;
        option.textContent = board.board_name;
        select.appendChild(option);
      });
      select.value = currentValue || 'all';
    }
    
    function renderAdminTable() {
      const tbody = document.getElementById('admin-table-body');
      if (!tbody) return;
      const filter = document.getElementById('admin-board-filter').value;
      let filteredBookings = filter === 'all' ? bookings : bookings.filter(b => b.board_id === filter);
      if (filteredBookings.length === 0) {
        tbody.innerHTML = '<tr><td colspan="5" class="px-4 py-8 text-center text-gray-500">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</td></tr>';
        return;
      }
      tbody.innerHTML = filteredBookings.map(booking => {
        const board = boards.find(b => b.board_id === booking.board_id);
        return `
          <tr class="hover:bg-gray-50">
            <td class="px-4 py-3">${board ? board.board_name : '-'}</td>
            <td class="px-4 py-3 font-semibold">${booking.booked_by}</td>
            <td class="px-4 py-3"><span class="px-2 py-1 bg-indigo-100 text-indigo-700 rounded-lg font-mono font-bold">${booking.number.toString().padStart(2, '0')}</span></td>
            <td class="px-4 py-3">‡∏ø${board ? board.price_per_number.toLocaleString() : '-'}</td>
            <td class="px-4 py-3 text-sm text-gray-500">${new Date(booking.booked_at).toLocaleString('th-TH')}</td>
          </tr>
        `;
      }).join('');
    }
    
    function renderAdminStockTable() {
      const tbody = document.getElementById('admin-stock-table');
      if (!tbody) return;
      if (products.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" class="px-4 py-8 text-center text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</td></tr>';
        return;
      }
      tbody.innerHTML = products.map(product => {
        const sellPrice = Number(product.sell_price) || 0;
        const buyPrice = Number(product.buy_price) || 0;
        const sold = Number(product.sold_quantity) || 0;
        const stock = Number(product.stock_quantity) || 0;
        const profit = (sellPrice - buyPrice) * sold;
        
        return `
          <tr class="hover:bg-gray-50">
            <td class="px-4 py-3 font-semibold">${product.product_name}</td>
            <td class="px-4 py-3 text-right text-red-600">‡∏ø${Math.round(buyPrice).toLocaleString()}</td>
            <td class="px-4 py-3 text-right text-green-600">‡∏ø${Math.round(sellPrice).toLocaleString()}</td>
            <td class="px-4 py-3 text-center"><span class="px-2 py-1 bg-amber-100 text-amber-600 rounded-lg font-bold">${Math.round(stock)}</span></td>
            <td class="px-4 py-3 text-center"><span class="px-2 py-1 bg-green-100 text-green-600 rounded-lg font-bold">${Math.round(sold)}</span></td>
            <td class="px-4 py-3 text-right font-bold text-emerald-600">‡∏ø${Math.round(profit).toLocaleString()}</td>
            <td class="px-4 py-3 text-center">
              <div class="flex gap-2 justify-center">
                <button onclick='showSellModal(${JSON.stringify(product).replace(/'/g, "&apos;")})' ${stock <= 0 ? 'disabled' : ''} class="p-2 hover:bg-green-100 rounded-lg transition-colors text-green-500 disabled:opacity-50 disabled:cursor-not-allowed">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                </button>
                <button onclick='showEditProductModal(${JSON.stringify(product).replace(/'/g, "&apos;")})' class="p-2 hover:bg-orange-100 rounded-lg transition-colors text-orange-500">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"/></svg>
                </button>
                <button onclick='deleteProduct(${JSON.stringify(product).replace(/'/g, "&apos;")})' class="p-2 hover:bg-red-100 rounded-lg transition-colors text-red-500">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>
                </button>
              </div>
            </td>
          </tr>
        `;
      }).join('');
    }
    
    function exportExcel() {
      const filter = document.getElementById('admin-board-filter').value;
      let filteredBookings = filter === 'all' ? bookings : bookings.filter(b => b.board_id === filter);
      let csv = '‡πÅ‡∏ú‡∏á,‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏≠‡∏á,‡πÄ‡∏•‡∏Ç,‡∏£‡∏≤‡∏Ñ‡∏≤,‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏á\n';
      filteredBookings.forEach(booking => {
        const board = boards.find(b => b.board_id === booking.board_id);
        csv += `"${board ? board.board_name : '-'}","${booking.booked_by}","${booking.number.toString().padStart(2, '0')}","${board ? board.price_per_number : 0}","${new Date(booking.booked_at).toLocaleString('th-TH')}"\n`;
      });
      const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = `‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á_${new Date().toISOString().split('T')[0]}.csv`;
      link.click();
      showToast('Export ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
    }
    
    // INIT
    function init() {
      loadDataFromFirebase();
      document.addEventListener('click', (e) => {
        if (!e.target.closest('[id^="menu-"]') && !e.target.closest('button')) {
          closeAllMenus();
        }
      });
    }
    init();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c50c2a75038f4cf',t:'MTc2OTYwNjE0Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
